var serviceMap=angular.module("serviceMap",[]);serviceMap.controller("ServicesSearch",["$scope","$filter","dataService",function(a,b,c){a.services=[],a.servicesPerPage=20,a.currentPage=1,a.query="",c.getData(function(c){a.services=c.services,a.departments=c.departments,a.audiences=c.audiences,a.numPages=function(){var c=a.services;return""!==a.query&&(c=b("filter")(c,a.query)),c=b("filterTags")(c,a.departments,a.audiences),Math.ceil(c.length/a.servicesPerPage)}}),a.range=function(a){return new Array(a)},a.changePage=function(b){b>=1&&b<=a.numPages()&&(a.currentPage=b)}}]),serviceMap.filter("startFrom",function(){return function(a,b){return b=+b,a.slice(b)}}),serviceMap.filter("isSelected",function(){return function(a){var b={};return void 0!==a&&Object.keys(a).forEach(function(c){a[c]!==!1&&(b[c]=!0)}),b}}),serviceMap.filter("filterTags",["$filter",function(a){return function(b,c,d){var e=[],f=[],g=b;return void 0===b?b:(void 0!==c&&Object.keys(c).forEach(function(a){c[a]!==!1&&e.push(a)}),void 0!==d&&Object.keys(d).forEach(function(a){d[a]!==!1&&f.push(a)}),e.length>0&&(g=a("filter")(g,function(a){var b=!1;return e.forEach(function(c){return a.owner===c?(b=!0,!0):void 0}),b})),f.length>0&&(g=a("filter")(g,function(a){var b=!1;return f.forEach(function(c){return-1!==a.audiences.indexOf(c)?(b=!0,!0):void 0}),b})),g)}}]),serviceMap.factory("dataService",["$http",function(a){function b(a){var b={};return a.forEach(function(a){void 0===b[a.owner]&&(b[a.owner]=!1)}),b}function c(a){var b={};return a.forEach(function(a){var c=a.audiences.split(",");c.forEach(function(a){void 0===b[a]&&(b[a]=!1)})}),b}var d={};return d.getData=function(d){a.get("data/export.json").success(function(a){a.departments=b(a.services),a.audiences=c(a.services),d(a)}).error(d)},d}]);